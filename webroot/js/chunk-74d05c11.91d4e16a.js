(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74d05c11","chunk-2d21e3e9"],{b1e5:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24}},[e("a-card",{style:t.cardStyle,attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"仓库",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple",maxTagCount:1,optionFilterProp:"children",showSearch:"",placeholder:"请选择仓库"},model:{value:t.depotSelected,callback:function(e){t.depotSelected=e},expression:"depotSelected"}},t._l(t.depotList,(function(a,r){return e("a-select-option",{attrs:{value:a.id}},[t._v("\n                    "+t._s(a.depotName)+"\n                  ")])})),1)],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"月份",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-month-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择月份","default-value":t.moment(t.currentMonth,t.monthFormat),format:t.monthFormat},on:{change:t.onChange}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"商品信息",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-input",{attrs:{placeholder:"条码/名称/规格/型号"},model:{value:t.queryParam.materialParam,callback:function(e){t.$set(t.queryParam,"materialParam",e)},expression:"queryParam.materialParam"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-button",{attrs:{type:"primary"},on:{click:t.searchQuery}},[t._v("查询")]),e("a-button",{directives:[{name:"print",rawName:"v-print",value:"#reportPrint",expression:"'#reportPrint'"}],staticStyle:{"margin-left":"8px"},attrs:{icon:"printer"}},[t._v("打印")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"download"},on:{click:t.exportExcel}},[t._v("导出")]),e("a",{staticStyle:{"margin-left":"8px"},on:{click:t.handleToggleSearch}},[t._v("\n                  "+t._s(t.toggleSearchStatus?"收起":"展开")+"\n                  "),e("a-icon",{attrs:{type:t.toggleSearchStatus?"up":"down"}})],1)],1)]),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",[e("span",[t._v("本月总结存："+t._s(t.totalStockStr)+"，总结存金额："+t._s(t.totalCountMoneyStr))])])],1),t.toggleSearchStatus?[e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"类别",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-tree-select",{staticStyle:{width:"100%"},attrs:{dropdownStyle:{maxHeight:"200px",overflow:"auto"},"allow-clear":"",treeData:t.categoryTree,placeholder:"请选择类别"},model:{value:t.queryParam.categoryId,callback:function(e){t.$set(t.queryParam,"categoryId",e)},expression:"queryParam.categoryId"}})],1)],1)]:t._e()],2)],1)],1),e("section",{ref:"print",attrs:{id:"reportPrint"}},[e("a-table",{ref:"table",attrs:{bordered:"",size:"middle",rowKey:"id",columns:t.columns,dataSource:t.dataSource,components:t.handleDrag(t.columns),pagination:!1,scroll:t.scroll,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"customRenderStock",fn:function(a,r){return[e("a-tooltip",{attrs:{title:r.bigUnitStock}},[t._v("\n              "+t._s(a)+"\n            ")])]}}])}),e("a-row",{staticStyle:{"margin-top":"8px","text-align":"right"},attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-pagination",{attrs:{size:"small","show-size-changer":"",showQuickJumper:!0,current:t.ipagination.current,"page-size":t.ipagination.pageSize,"page-size-options":t.ipagination.pageSizeOptions,total:t.ipagination.total,"show-total":function(e,a){return"共 ".concat(e-Math.ceil(e/t.ipagination.pageSize)," 条")}},on:{change:t.paginationChange,showSizeChange:t.paginationShowSizeChange},scopedSlots:t._u([{key:"buildOptionText",fn:function(a){return[e("span",[t._v(t._s(a.value-1)+"条/页")])]}}])})],1)],1)],1)])],1)],1)},o=[],n=a("b65a"),i=a("0fea"),l=a("4ec3"),s=a("ca00"),c=a("d579"),d=a("2f42"),u=a.n(d),p=a("1f37"),m={name:"InOutStockReport",mixins:[n["a"]],components:{JEllipsis:c["default"]},data:function(){return{currentMonth:u()().format("YYYY-MM"),monthFormat:"YYYY-MM",labelCol:{span:5},wrapperCol:{span:18,offset:1},queryParam:{depotId:"",monthTime:u()().format("YYYY-MM"),materialParam:"",categoryId:"",mpList:Object(s["g"])(p["a"].ls.get("materialPropertyList"))},ipagination:{pageSize:11,pageSizeOptions:["11","21","31","101","201"]},depotSelected:[],depotList:[],categoryTree:[],totalStockStr:"0",totalCountMoneyStr:"0",columns:[{title:"#",dataIndex:"rowIndex",width:40,align:"center",customRender:function(t,e,a){return"合计"!==t?parseInt(a)+1:t}},{title:"条码",dataIndex:"barCode",width:100},{title:"名称",dataIndex:"materialName",width:120,ellipsis:!0},{title:"规格",dataIndex:"materialStandard",width:80,ellipsis:!0},{title:"型号",dataIndex:"materialModel",width:80,ellipsis:!0},{title:"扩展信息",dataIndex:"materialOther",width:80,ellipsis:!0},{title:"单位",dataIndex:"unitName",width:60,ellipsis:!0},{title:"单价",dataIndex:"unitPrice",sorter:function(t,e){return t.unitPrice-e.unitPrice},width:60},{title:"上月结存数量",dataIndex:"prevSum",sorter:function(t,e){return t.prevSum-e.prevSum},width:80},{title:"入库数量",dataIndex:"inSum",sorter:function(t,e){return t.inSum-e.inSum},width:60},{title:"出库数量",dataIndex:"outSum",sorter:function(t,e){return t.outSum-e.outSum},width:60},{title:"本月结存数量",dataIndex:"thisSum",sorter:function(t,e){return t.thisSum-e.thisSum},width:80,scopedSlots:{customRender:"customRenderStock"}},{title:"结存金额",dataIndex:"thisAllPrice",sorter:function(t,e){return t.thisAllPrice-e.thisAllPrice},width:60}],url:{list:"/depotItem/findByAll",totalCountMoney:"/depotItem/totalCountMoney",exportXlsUrl:"/depotItem/exportExcel"}}},created:function(){this.getDepotData(),this.loadTreeData(),this.getTotalCountMoney()},mounted:function(){this.scroll.x=1620},methods:{moment:u.a,getQueryParams:function(){var t=Object.assign({},this.queryParam,this.isorter);return this.depotSelected&&this.depotSelected.length>0&&(t.depotIds=this.depotSelected.join()),t.monthTime=this.queryParam.monthTime,t.field=this.getQueryField(),t.currentPage=this.ipagination.current,t.pageSize=this.ipagination.pageSize-1,t},getDepotData:function(){var t=this;Object(i["c"])("/depot/findDepotByCurrentUser").then((function(e){200===e.code?t.depotList=e.data:t.$message.info(e.data)}))},getTotalCountMoney:function(){var t=this,e=Object.assign({},this.queryParam,this.isorter);this.depotSelected&&this.depotSelected.length>0&&(e.depotIds=this.depotSelected.join()),e.monthTime=this.queryParam.monthTime,Object(i["c"])(this.url.totalCountMoney,e).then((function(e){e&&200===e.code&&(t.totalStockStr=e.data.totalStock.toFixed(2),t.totalCountMoneyStr=e.data.totalCount.toFixed(2))}))},onChange:function(t,e){this.queryParam.monthTime=e},loadTreeData:function(){var t=this,e={id:""};Object(l["sb"])(e).then((function(e){if(e){t.categoryTree=[];for(var a=0;a<e.length;a++){var r=e[a];t.categoryTree.push(r)}}}))},searchQuery:function(){""==this.queryParam.monthTime?this.$message.warning("请选择月份！"):(this.loadData(1),this.getTotalCountMoney())},exportExcel:function(){for(var t=[["条码","名称","规格","型号","扩展信息","单位","单价","上月结存数量","入库数量","出库数量","本月结存数量","结存金额"]],e=0;e<this.dataSource.length;e++){var a=this.dataSource[e],r=[a.barCode,a.materialName,a.materialStandard,a.materialModel,a.materialOther,a.unitName,a.unitPrice,a.prevSum,a.inSum,a.outSum,a.thisSum,a.thisAllPrice];t.push(r)}Object(s["l"])(Object(s["q"])(t),"进销存统计")}}},h=m,g=(a("edd0"),a("e607")),S=Object(g["a"])(h,r,o,!1,null,"47b55078",null);e["default"]=S.exports},ce4a:function(t,e,a){},d579:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-tooltip",{attrs:{placement:"topLeft"}},[e("template",{slot:"title"},[e("span",[t._v(t._s(t.value))])]),t._v("\n  "+t._s(t._f("ellipsis")(t.value,t.length))+"\n")],2)},o=[],n={name:"JEllipsis",props:{value:{type:String,required:!1},length:{type:Number,required:!1,default:25}}},i=n,l=a("e607"),s=Object(l["a"])(i,r,o,!1,null,"4de15389",null);e["default"]=s.exports},edd0:function(t,e,a){"use strict";a("ce4a")}}]);