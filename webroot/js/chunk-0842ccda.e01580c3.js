(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0842ccda"],{"956c":function(t,e,a){"use strict";a("f21f")},d083:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("a-modal",{staticStyle:{top:"12%",height:"90%","overflow-y":"hidden"},attrs:{width:t.modalWidth,visible:t.visible,title:t.title,cancelText:"关闭",wrapClassName:"ant-modal-cust-warp"},on:{ok:t.handleSubmit,cancel:t.close}},[e("a-row",{staticStyle:{padding:"10px",margin:"-10px"},attrs:{gutter:10}},[e("a-col",{attrs:{md:16,sm:24}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"序列号"}},[e("a-input",{ref:"name",attrs:{placeholder:"请输入序列号并回车"},model:{value:t.queryParam.name,callback:function(e){t.$set(t.queryParam,"name",e)},expression:"queryParam.name"}})],1)],1),e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-col",{attrs:{md:12,sm:24}},[e("a-button",{attrs:{type:"primary"},on:{click:t.onSearch}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.checkAll}},[t._v("全选")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.searchReset(1)}}},[t._v("重置")])],1)],1)],1)],1)],1)]),e("a-col",{attrs:{md:8,sm:24}},[e("span",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v("此处为已选中的序列号列表")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.clearAllSn}},[t._v("清空")])],1)],1),e("a-row",{staticStyle:{padding:"10px",margin:"-10px"},attrs:{gutter:10}},[e("a-col",{attrs:{md:16,sm:24}},[e("a-table",{ref:"table",staticStyle:{width:"95%"},attrs:{scroll:t.scrollTrigger,size:"middle",rowKey:"id",columns:t.leftColumns,dataSource:t.dataSource,pagination:t.ipagination,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"action",fn:function(a,i){return e("span",{},[e("a",{on:{click:function(e){return t.checkSn(i)}}},[t._v("选中")])])}}])})],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-table",{ref:"table",attrs:{scroll:t.scrollTrigger,size:"middle",rowKey:"id",columns:t.rightColumns,dataSource:t.checkDataSource,pagination:!1,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"action",fn:function(a,i){return e("span",{},[e("a",{on:{click:function(e){return t.removeSn(i)}}},[t._v("移除")])])}}])})],1)],1)],1)},r=[],s=(a("0fea"),a("4ec3")),o=a("b65a"),n={name:"JSelectSnModal",mixins:[o["a"]],components:{},props:["rows","multi","barCode"],data:function(){return{modalWidth:1e3,queryParam:{name:"",depotItemId:"",depotId:"",barCode:""},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},categoryTree:[],leftColumns:[{dataIndex:"serialNumber",title:"序列号",width:100,align:"left"},{dataIndex:"inBillNo",title:"入库单号",width:100,align:"left"},{dataIndex:"createTimeStr",title:"创建时间",width:100,align:"left"},{dataIndex:"action",title:"操作",align:"center",width:50,scopedSlots:{customRender:"action"}}],rightColumns:[{dataIndex:"serialNumber",title:"序列号",width:100,align:"left"},{tdataIndex:"action",title:"操作",align:"center",width:50,scopedSlots:{customRender:"action"}}],scrollTrigger:{y:460},dataSource:[],checkDataSource:[],selectedRowKeys:[],selectRows:[],selectIds:[],title:"选择序列号",ipagination:{current:1,pageSize:10,pageSizeOptions:["10","20","30","100","200"],showTotal:function(t,e){return e[0]+"-"+e[1]+" 共"+t+"条"},showQuickJumper:!0,showSizeChanger:!0,total:0},isorter:{column:"createTime",order:"desc"},departTree:[],depotList:[],visible:!1,form:this.$form.createForm(this),loading:!1,expandedKeys:[]}},computed:{getType:function(){return 1==this.multi?"checkbox":"radio"}},watch:{barCode:{immediate:!0,handler:function(){this.initBarCode()}}},created:function(){this.loadData()},methods:{initBarCode:function(){this.barCode?this.$emit("initComp",this.barCode):this.$emit("initComp","")},loadData:function(t){var e=this;if(this.rows&&JSON.parse(this.rows).depotId&&JSON.parse(this.rows).barCode){var a=JSON.parse(this.rows).id;a.length<=19&&(this.queryParam.depotItemId=a-0),this.queryParam.depotId=JSON.parse(this.rows).depotId-0,this.queryParam.barCode=JSON.parse(this.rows).barCode}1===t&&(this.ipagination.current=1),this.loading=!0;var i=this.getQueryParams();Object(s["gb"])(i).then((function(t){if(t&&200===t.code&&(e.dataSource=t.data.rows,e.ipagination.total=t.data.total,1===t.data.total&&e.queryParam.name===e.dataSource[0].serialNumber)){var a={id:e.dataSource[0].id,serialNumber:e.dataSource[0].serialNumber};e.checkSn(a),e.queryParam.name=""}})).finally((function(){e.loading=!1}))},showModal:function(){var t=this;if(this.visible=!0,this.$nextTick((function(){return t.$refs.name.focus()})),this.loadData(),this.form.resetFields(),this.rows){this.checkDataSource=[];for(var e=JSON.parse(this.rows),a=e.snList.split(","),i=0;i<a.length;i++){var r={id:a[i],serialNumber:a[i]};this.checkDataSource.push(r)}}},getQueryParams:function(){var t=Object.assign({},this.queryParam,this.isorter);return t.page=this.ipagination.current,t.rows=this.ipagination.pageSize,t},getQueryField:function(){for(var t="id,",e=0;e<this.columns.length;e++)t+=","+this.columns[e].dataIndex;return t},checkAll:function(){this.checkDataSource=[];for(var t=this.dataSource,e=0;e<t.length;e++){var a={id:t[e].id,serialNumber:t[e].serialNumber};this.checkDataSource.push(a)}},clearAllSn:function(){this.checkDataSource=[]},searchReset:function(t){var e=this;if(0!==t){if(this.rows&&(this.queryParam.name="",JSON.parse(this.rows).depotId&&JSON.parse(this.rows).barCode)){var a=JSON.parse(this.rows).id;a.length<=19&&(this.queryParam.depotItemId=a-0),this.queryParam.depotId=JSON.parse(this.rows).depotId-0,this.queryParam.barCode=JSON.parse(this.rows).barCode}e.loadData(1)}e.selectedRowKeys=[],e.selectIds=[]},close:function(){this.searchReset(0),this.visible=!1},handleTableChange:function(t,e,a){Object.keys(a).length>0&&(this.isorter.column=a.field,this.isorter.order="ascend"===a.order?"asc":"desc"),this.ipagination=t,this.loadData()},handleSubmit:function(){var t=this;this.getSelectRows(),t.$emit("ok",t.selectRows,t.selectIds),t.searchReset(0),t.close()},checkSn:function(t){for(var e={id:t.id,serialNumber:t.serialNumber},a=this.checkDataSource,i=!1,r=0;r<a.length;r++)a[r].serialNumber===t.serialNumber&&(i=!0);i?this.$message.warning("抱歉，此序列号已经选择过！"):this.checkDataSource.push(e)},removeSn:function(t){for(var e=this.checkDataSource,a=[],i=0;i<e.length;i++)e[i].id!==t.id&&a.push(e[i]);this.checkDataSource=a},getSelectRows:function(){var t="";this.selectRows=this.checkDataSource;for(var e=this.checkDataSource,a=0;a<e.length;a++)t=t+","+e[a].serialNumber;this.selectIds=t.substring(1)},onSelectChange:function(t,e){this.selectedRowKeys=t,this.selectionRows=e},onSearch:function(){this.loadData(1)},modalFormOk:function(){this.loadData()}}},c=n,l=(a("956c"),a("e607")),d=Object(l["a"])(c,i,r,!1,null,"8dff58fe",null);e["default"]=d.exports},f21f:function(t,e,a){}}]);