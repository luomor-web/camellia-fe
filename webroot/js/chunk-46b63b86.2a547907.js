(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46b63b86","chunk-65088f60","chunk-95629894","chunk-2d225b46","chunk-2d0e55b5","chunk-2d0f1595"],{"255b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{ref:"container"},[t("a-modal",{staticStyle:{top:"100px",height:"55%"},attrs:{title:e.title,width:700,visible:e.visible,confirmLoading:e.confirmLoading,getContainer:function(){return e.$refs.container},maskStyle:{top:"93px",left:"154px"},wrapClassName:e.wrapClassNameInfo(),mask:e.isDesktop(),maskClosable:!1,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("template",{slot:"footer"},[e.isReadOnly?t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n        关闭\n      ")]):e._e()],1),t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form,id:"unitModal"}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"基本单位"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["basicUnit",e.validatorRules.basicUnit],expression:"[ 'basicUnit', validatorRules.basicUnit]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入基本单位(小单位)"}})],1)],1),t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"副单位"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["otherUnit"],expression:"[ 'otherUnit' ]",modifiers:{trim:!0}}],staticStyle:{width:"48%"},attrs:{placeholder:"请输入副单位(大单位)"}}),e._v("\n          =\n          "),t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["ratio"],expression:"[ 'ratio' ]",modifiers:{trim:!0}}],staticStyle:{width:"48%"},attrs:{suffix:"基本单位",placeholder:"请输入比例"}})],1)],1),t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"副单位2"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["otherUnitTwo"],expression:"[ 'otherUnitTwo' ]",modifiers:{trim:!0}}],staticStyle:{width:"48%"},attrs:{placeholder:"请输入副单位2(大单位)"}}),e._v("\n          =\n          "),t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["ratioTwo"],expression:"[ 'ratioTwo' ]",modifiers:{trim:!0}}],staticStyle:{width:"48%"},attrs:{suffix:"基本单位",placeholder:"请输入比例2"}})],1)],1),t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"副单位3"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["otherUnitThree"],expression:"[ 'otherUnitThree' ]",modifiers:{trim:!0}}],staticStyle:{width:"48%"},attrs:{placeholder:"请输入副单位3(大单位)"}}),e._v("\n          =\n          "),t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["ratioThree"],expression:"[ 'ratioThree' ]",modifiers:{trim:!0}}],staticStyle:{width:"48%"},attrs:{suffix:"基本单位",placeholder:"请输入比例3"}})],1)],1)],1)],2)],1)},r=[],o=a("85ee"),n=a.n(o),l=a("4ec3"),s=a("ca00"),d=a("61f7"),c=a("ac0d"),u={name:"UnitModal",mixins:[c["b"]],data:function(){return{title:"操作",visible:!1,model:{},isReadOnly:!1,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{basicUnit:{rules:[{required:!0,message:"请输入基本单位!"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]},otherUnit:{rules:[{required:!0,message:"请输入副单位!"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]},ratio:{rules:[{required:!0,message:"请输入比例!"},{validator:this.validateRatio}]}}}},created:function(){},methods:{add:function(){this.edit({})},edit:function(e){var t=this;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(n()(t.model,"basicUnit","otherUnit","ratio","otherUnitTwo","ratioTwo","otherUnitThree","ratioThree")),Object(s["a"])("unitModal")}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this,t=this;this.form.validateFields((function(a,i){if(!a){t.confirmLoading=!0;var r,o=Object.assign(e.model,i);if(!o.otherUnit)return t.$message.warning("抱歉，副单位不能为空！"),void(t.confirmLoading=!1);if(o.otherUnit){if(!o.ratio)return t.$message.warning("抱歉，比例不能为空！"),void(t.confirmLoading=!1);if(!Object(d["a"])(o.ratio))return t.$message.warning("抱歉，比例只能为数字，最多三位小数！"),void(t.confirmLoading=!1)}if(o.otherUnitTwo){if(!o.ratioTwo)return t.$message.warning("抱歉，比例2不能为空！"),void(t.confirmLoading=!1);if(!Object(d["a"])(o.ratioTwo))return t.$message.warning("抱歉，比例2只能为数字，最多三位小数！"),void(t.confirmLoading=!1)}if(o.otherUnitThree){if(!o.ratioThree)return t.$message.warning("抱歉，比例3不能为空！"),void(t.confirmLoading=!1);if(!Object(d["a"])(o.ratioThree))return t.$message.warning("抱歉，比例3只能为数字，最多三位小数！"),void(t.confirmLoading=!1)}if(!o.otherUnitTwo&&o.otherUnitThree)return t.$message.warning("抱歉，需要先输入副单位2再输入副单位3！"),void(t.confirmLoading=!1);if(o.basicUnit===o.otherUnit)return t.$message.warning("抱歉，基本单位与副单位不能相同！"),void(t.confirmLoading=!1);if(o.basicUnit===o.otherUnitTwo)return t.$message.warning("抱歉，基本单位与副单位2不能相同！"),void(t.confirmLoading=!1);if(o.basicUnit===o.otherUnitThree)return t.$message.warning("抱歉，基本单位与副单位3不能相同！"),void(t.confirmLoading=!1);r=e.model.id?Object(l["Q"])(o):Object(l["k"])(o),r.then((function(e){200===e.code?t.$emit("ok"):t.$message.warning(e.data.message)})).finally((function(){t.confirmLoading=!1,t.close()}))}}))},handleCancel:function(){this.close()},validateRatio:function(e,t,a){t>1?a():a("比例必须大于1")}}},m=u,h=a("e607"),f=Object(h["a"])(m,i,r,!1,null,"010acea2",null);t["default"]=f.exports},"3d9e":function(e,t,a){"use strict";a("790b")},4319:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("j-modal",{style:e.modalStyle,attrs:{title:e.title,width:e.width,visible:e.visible,confirmLoading:e.confirmLoading,prefixNo:e.prefixNo,switchHelp:"",switchFullscreen:"",cancelText:"关闭",id:e.prefixNo},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("template",{slot:"footer"},[e.isReadOnly?t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n      关闭\n    ")]):e._e()],1),t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-tabs",{attrs:{"default-active-key":"1"}},[t("a-tab-pane",{key:"1",attrs:{tab:"基本信息",id:"materialHeadModal",forceRender:""}},[t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"名称","data-step":"1","data-title":"名称","data-intro":"名称必填，可以重复"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",e.validatorRules.name],expression:"[ 'name', validatorRules.name ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入名称"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"规格","data-step":"2","data-title":"规格","data-intro":"规格不必填，比如：10克"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["standard",e.validatorRules.standard],expression:"[ 'standard', validatorRules.standard ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入规格"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"型号","data-step":"3","data-title":"型号","data-intro":"型号是比规格更小的属性，比如：RX-01"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["model",e.validatorRules.model],expression:"[ 'model', validatorRules.model ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入型号"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},label:"单位","data-step":"4","data-title":"单位","data-intro":"此处支持单个单位和多单位，勾选多单位就可以切换到多单位的下拉框，多单位需要先在【计量单位】页面进行录入。\n                比如牛奶有瓶和箱两种单位，12瓶=1箱，这就构成了多单位，多单位中有个换算比例"}},[t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{staticStyle:{padding:"0px 0px 0px 12px"},attrs:{lg:15,md:15,sm:24}},[e.unitChecked?e._e():t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["unit",e.validatorRules.unit],expression:"[ 'unit', validatorRules.unit ]",modifiers:{trim:!0}}],attrs:{placeholder:"输入单位"},on:{change:e.onlyUnitOnChange}}),e.unitChecked?t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["unitId",e.validatorRules.unitId],expression:"[ 'unitId', validatorRules.unitId ]"}],attrs:{value:e.unitList,placeholder:"选择多单位",showSearch:"",optionFilterProp:"children",dropdownMatchSelectWidth:!1},on:{change:e.manyUnitOnChange},scopedSlots:e._u([{key:"dropdownRender",fn:function(a){return t("div",{},[t("v-nodes",{attrs:{vnodes:a}}),t("a-divider",{staticStyle:{margin:"4px 0"}}),t("div",{staticStyle:{padding:"4px 8px",cursor:"pointer"},on:{mousedown:function(e){return e.preventDefault()},click:e.addUnit}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 新增计量单位")],1)],1)}}],null,!1,1253190182)},e._l(e.unitList,(function(a,i){return t("a-select-option",{key:i,attrs:{value:a.id}},[e._v("\n                        "+e._s(a.name)+"\n                      ")])})),1):e._e()],1),t("a-col",{staticStyle:{padding:"0px","text-align":"center"},attrs:{lg:9,md:9,sm:24}},[t("a-checkbox",{attrs:{checked:e.unitChecked},on:{change:e.unitOnChange}},[e._v("多单位")])],1)],1)],1)],1)],1),t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"颜色","data-step":"5","data-title":"颜色","data-intro":"请填写商品的颜色，如果是多属性商品可以不填（下面有多属性开关）"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["color"],expression:"[ 'color' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入颜色"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"基础重量","data-step":"6","data-title":"基础重量","data-intro":"请填写基本单位对应的重量，用于计算按重量分摊费用时单据中各行商品分摊的费用成本"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["weight"],expression:"[ 'weight' ]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入基础重量(kg)"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"保质期","data-step":"7","data-title":"保质期","data-intro":"保质期指的是商品的保质期(天)，主要针对带生产日期的，此类商品一般有批号"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["expiryNum"],expression:"[ 'expiryNum' ]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入保质期(天)"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},label:"类别","data-step":"8","data-title":"类别","data-intro":"类别需要在【商品类别】页面进行录入，录入之后在此处进行调用"}},[t("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["categoryId"],expression:"[ 'categoryId' ]"}],staticStyle:{width:"100%"},attrs:{dropdownStyle:{maxHeight:"200px",overflow:"auto"},"allow-clear":"",treeData:e.categoryTree,placeholder:"请选择类别"}})],1)],1)],1),t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"序列号","data-step":"9","data-title":"序列号","data-intro":"此处是商品的序列号开关，如果选择了有，则在采购入库单据需要录入该商品的序列号，在销售出库单据需要选择该商品的序列号进行出库"}},[t("a-tooltip",{attrs:{title:"如果选择为有，则在采购入库单需要录入该商品的序列号"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["enableSerialNumber"],expression:"[ 'enableSerialNumber' ]"}],attrs:{placeholder:"有无序列号"}},[t("a-select-option",{attrs:{value:"1"}},[e._v("有")]),t("a-select-option",{attrs:{value:"0"}},[e._v("无")])],1)],1)],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"批号","data-step":"10","data-title":"批号","data-intro":"此处是商品的批号开关，如果选择了有，则在采购入库单据需要录入该商品的批号和有效期，在销售出库单据需要选择该商品的批号进行出库"}},[t("a-tooltip",{attrs:{title:"如果选择为有，则在采购入库单需要录入该商品的批号和有效期"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["enableBatchNumber"],expression:"[ 'enableBatchNumber' ]"}],attrs:{placeholder:"有无批号"}},[t("a-select-option",{attrs:{value:"1"}},[e._v("有")]),t("a-select-option",{attrs:{value:"0"}},[e._v("无")])],1)],1)],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"仓位货架","data-step":"11","data-title":"仓位货架","data-intro":"仓位货架指的是仓库中的仓位和货架号，主要适用于仓库较大的场景，方便查找商品的准确位置"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["position"],expression:"[ 'position' ]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入仓位货架"}})],1)],1),e.model.id?e._e():t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},label:"多属性","data-step":"12","data-title":"多属性","data-intro":"多属性是针对的sku商品（比如服装、鞋帽行业），此处开关如果启用就可以在下方进行多sku的配置，配置具体的颜色、尺码之类的组合"}},[t("a-tooltip",{attrs:{title:"多属性针对服装、鞋帽等行业，需要先录入单位才能激活此处输入框"}},[e.manySkuStatus?e._e():t("a-tag",{staticClass:"tag-info"},[e._v("需要先录入单位才能激活")]),t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["manySku"],expression:"[ 'manySku' ]"},{name:"show",rawName:"v-show",value:e.manySkuStatus,expression:"manySkuStatus"}],attrs:{mode:"multiple",showSearch:"",optionFilterProp:"children",placeholder:"请选择多属性（可多选）"},on:{change:e.onManySkuChange}},e._l(e.materialAttributeList,(function(a,i){return t("a-select-option",{key:i,attrs:{value:a.value,disabled:a.disabled}},[e._v("\n                      "+e._s(a.name)+"\n                    ")])})),1)],1)],1)],1)],1),t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[e.manySkuSelected>=1?t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},label:e.skuOneTitle}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["skuOne"],expression:"[ 'skuOne' ]"}],attrs:{mode:"multiple",showSearch:"",optionFilterProp:"children",placeholder:"请选择（可多选）"},on:{select:e.onSkuChange,deselect:e.onSkuOneDeSelect}},e._l(e.skuOneList,(function(a,i){return t("a-select-option",{key:i,attrs:{value:a.value}},[e._v("\n                    "+e._s(a.name)+"\n                  ")])})),1)],1)],1):e._e(),e.manySkuSelected>=2?t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},label:e.skuTwoTitle}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["skuTwo"],expression:"[ 'skuTwo' ]"}],attrs:{mode:"multiple",showSearch:"",optionFilterProp:"children",placeholder:"请选择（可多选）"},on:{select:e.onSkuChange,deselect:e.onSkuTwoDeSelect}},e._l(e.skuTwoList,(function(a,i){return t("a-select-option",{key:i,attrs:{value:a.value}},[e._v("\n                    "+e._s(a.name)+"\n                  ")])})),1)],1)],1):e._e()],1),t("div",{staticStyle:{"margin-top":"8px"},attrs:{id:"materialDetailModal"}},[t("j-editable-table",{ref:"editableMeTable",attrs:{loading:e.meTable.loading,columns:e.meTable.columns,dataSource:e.meTable.dataSource,height:300,minWidth:1e3,maxHeight:300,rowNumber:!1,rowSelection:!0,actionButton:!0},on:{valueChange:e.onValueChange,added:e.onAdded,deleted:e.onDeleted},scopedSlots:e._u([{key:"buttonAfter",fn:function(){return[t("a-button",{on:{click:function(t){return e.batchSetPrice("purchase")}}},[e._v("采购价-批量")]),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.batchSetPrice("commodity")}}},[e._v("零售价-批量")]),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.batchSetPrice("wholesale")}}},[e._v("销售价-批量")]),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.batchSetPrice("low")}}},[e._v("最低售价-批量")])]},proxy:!0}])}),t("batch-set-price-modal",{ref:"priceModalForm",on:{ok:e.batchSetPriceModalFormOk}})],1),t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:24,md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:{xs:{span:24},sm:{span:24}},label:""}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"[ 'remark' ]"}],staticStyle:{"margin-top":"8px"},attrs:{rows:1,placeholder:"请输入备注"}})],1)],1)],1)],1),t("a-tab-pane",{key:"2",attrs:{tab:"扩展信息",forceRender:""}},[e.mpShort.mfrs.enabled?t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:6,md:6,sm:6}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:e.mpShort.mfrs.name}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["mfrs"],expression:"[ 'mfrs' ]",modifiers:{trim:!0}}]})],1)],1)],1):e._e(),e.mpShort.otherField1.enabled?t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:6,md:6,sm:6}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:e.mpShort.otherField1.name}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["otherField1"],expression:"[ 'otherField1' ]",modifiers:{trim:!0}}]})],1)],1)],1):e._e(),e.mpShort.otherField2.enabled?t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:6,md:6,sm:6}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:e.mpShort.otherField2.name}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["otherField2"],expression:"[ 'otherField2' ]",modifiers:{trim:!0}}]})],1)],1)],1):e._e(),e.mpShort.otherField3.enabled?t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:6,md:6,sm:6}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:e.mpShort.otherField3.name}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["otherField3"],expression:"[ 'otherField3' ]",modifiers:{trim:!0}}]})],1)],1)],1):e._e()],1),t("a-tab-pane",{key:"3",attrs:{tab:"库存数量",forceRender:""}},[t("j-editable-table",{ref:"editableDepotTable",attrs:{loading:e.depotTable.loading,columns:e.depotTable.columns,dataSource:e.depotTable.dataSource,minWidth:1e3,maxHeight:300,rowNumber:!0,rowSelection:!1,actionButton:!1},scopedSlots:e._u([{key:"buttonAfter",fn:function(){return[t("a-button",{staticStyle:{margin:"0px 0px 8px 0px"},on:{click:function(t){return e.batchSetStock("initStock")}}},[e._v("期初库存-批量")]),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.batchSetStock("lowSafeStock")}}},[e._v("最低安全库存-批量")]),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.batchSetStock("highSafeStock")}}},[e._v("最高安全库存-批量")])]},proxy:!0}])}),t("batch-set-stock-modal",{ref:"stockModalForm",on:{ok:e.batchSetStockModalFormOk}})],1),t("a-tab-pane",{key:"4",attrs:{tab:"图片信息",forceRender:""}},[t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:18,md:18,sm:24}},[t("a-form-item",{attrs:{labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}},label:"图片信息"}},[t("j-image-upload",{attrs:{bizPath:"material",text:"上传",isMultiple:""},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1)],1),t("a-col",{attrs:{lg:6,md:6,sm:24}})],1),t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:18,md:18,sm:24}},[t("a-form-item",{attrs:{labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}},label:"上传提示"}},[e._v("\n                图片最多4张，且单张大小不超过1M\n              ")])],1),t("a-col",{attrs:{lg:6,md:6,sm:24}})],1)],1)],1)],1)],1),t("unit-modal",{ref:"unitModalForm",on:{ok:e.unitModalFormOk}})],2)},r=[],o=a("85ee"),n=a.n(o),l=a("93af"),s=a("9ff8"),d=a("255b"),c=a("7550"),u=a("e2e0"),m=a("4ec3"),h=a("ca00"),f=a("0fea"),p=a("e610"),b=a("2dab"),v=a("1f37");function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return t=k(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function k(e){var t=C(e,"string");return"symbol"===g(t)?t:String(t)}function C(e,t){if("object"!==g(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!==g(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var x={name:"MaterialModal",components:{BatchSetPriceModal:l["default"],BatchSetStockModal:s["default"],UnitModal:d["default"],JImageUpload:p["default"],JDate:b["default"],JEditableTable:c["default"],VNodes:{functional:!0,render:function(e,t){return t.props.vnodes}}},data:function(){return{title:"操作",width:"1300px",visible:!1,modalStyle:"",categoryTree:[],unitList:[],depotList:[],fileList:[],unitStatus:!1,manyUnitStatus:!0,unitChecked:!1,manySkuStatus:!1,switchDisabled:!1,barCodeSwitch:!1,maxBarCodeInfo:"",meDeleteIdList:[],prefixNo:"material",materialAttributeList:[],skuOneTitle:"属性1",skuTwoTitle:"属性2",skuOneList:[],skuTwoList:[],manySkuSelected:0,model:{},isReadOnly:!1,labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}},mpShort:{mfrs:{},otherField1:{},otherField2:{},otherField3:{}},meTable:{loading:!1,dataSource:[],columns:[{title:"条码",key:"barCode",width:"15%",type:u["a"].input,defaultValue:"",placeholder:"请输入${title}",validateRules:[{required:!0,message:"${title}不能为空"},{pattern:/^.{4,40}$/,message:"长度为4到40位"},{handler:this.validateBarCode}]},{title:"单位",key:"commodityUnit",width:"8%",type:u["a"].input,defaultValue:"",placeholder:"请输入${title}",validateRules:[{required:!0,message:"${title}不能为空"}]},{title:"多属性",key:"sku",width:"20%",type:u["a"].input,defaultValue:"",readonly:!0,placeholder:"请输入${title}"},{title:"采购价",key:"purchaseDecimal",width:"9%",type:u["a"].inputNumber,defaultValue:"",placeholder:"请输入${title}"},{title:"零售价",key:"commodityDecimal",width:"9%",type:u["a"].inputNumber,defaultValue:"",placeholder:"请输入${title}"},{title:"销售价",key:"wholesaleDecimal",width:"9%",type:u["a"].inputNumber,defaultValue:"",placeholder:"请输入${title}"},{title:"最低售价",key:"lowDecimal",width:"9%",type:u["a"].inputNumber,defaultValue:"",placeholder:"请输入${title}"}]},depotTable:{loading:!1,dataSource:[],columns:[{title:"仓库",key:"name",width:"15%",type:u["a"].normal},{title:"期初库存数量",key:"initStock",width:"15%",type:u["a"].inputNumber,defaultValue:"",placeholder:"请输入${title}"},{title:"最低安全库存数量",key:"lowSafeStock",width:"15%",type:u["a"].inputNumber,defaultValue:"",placeholder:"请输入${title}"},{title:"最高安全库存数量",key:"highSafeStock",width:"15%",type:u["a"].inputNumber,defaultValue:"",placeholder:"请输入${title}"}]},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{name:{rules:[{required:!0,message:"请输入名称!"},{max:100,message:"长度请小于100个字符",trigger:"blur"}]},standard:{rules:[{max:100,message:"长度请小于100个字符",trigger:"blur"}]},model:{rules:[{max:100,message:"长度请小于100个字符",trigger:"blur"}]},unit:{rules:[{required:!0,message:"请输入单位!"}]},unitId:{rules:[{required:!0,message:"请选择多单位!"}]}},url:{add:"/material/add",edit:"/material/update",materialsExtendList:"/materialsExtend/getDetailList",depotWithStock:"/depot/getAllListWithStock"}}},created:function(){this.loadParseMaterialProperty();var e=window.screen.width;this.width=e<1500?"1200px":"1400px"},methods:{getAllTable:function(){return Promise.all([Object(u["d"])(this,"editableMeTable"),Object(u["d"])(this,"editableDepotTable")])},add:function(){this.meTable.columns[2].type=u["a"].hidden,this.getAllTable().then((function(e){e[0].add()})),this.edit({}),this.$nextTick((function(){Object(h["k"])("material",11)}))},edit:function(e){var t=this;if(this.form.resetFields(),this.model=Object.assign({},e),this.activeKey="1",this.manySkuSelected=0,this.barCodeSwitch=!1,this.manySkuStatus=!1,this.maxBarCodeInfo="",this.visible=!0,this.meDeleteIdList=[],this.modalStyle="top:20px;height: 95%;","{}"===JSON.stringify(e)?this.fileList=[]:setTimeout((function(){t.fileList=e.imgName}),5),this.$nextTick((function(){t.form.setFieldsValue(n()(t.model,"name","standard","unit","unitId","model","color","categoryId","enableSerialNumber","enableBatchNumber","position","expiryNum","weight","remark","mfrs","otherField1","otherField2","otherField3")),Object(h["a"])("materialHeadModal"),Object(h["a"])("materialDetailModal")})),this.initMaterialAttribute(),this.loadTreeData(),this.loadUnitListData(),this.model.id){this.switchDisabled=!0,this.model.unit?(this.unitChecked=!1,this.unitStatus=!1,this.manyUnitStatus=!0):(this.unitChecked=!0,this.unitStatus=!0,this.manyUnitStatus=!1);var a={materialId:this.model.id};this.meTable.columns[2].readonly=!1,this.requestMeTableData(this.url.materialsExtendList,a,this.meTable),this.requestDepotTableData(this.url.depotWithStock,{mId:this.model.id},this.depotTable)}else this.switchDisabled=!1,this.meTable.columns[2].readonly=!0,this.requestDepotTableData(this.url.depotWithStock,{mId:0},this.depotTable)},requestMeTableData:function(e,t,a){var i=this;a.loading=!0,Object(f["c"])(e,t).then((function(e){for(var t=0;t<e.data.rows.length;t++)e.data.rows[t].sku?i.meTable.columns[2].type=u["a"].input:i.meTable.columns[2].type=u["a"].hidden;a.dataSource=e.data.rows||[]})).finally((function(){a.loading=!1}))},requestDepotTableData:function(e,t,a){a.loading=!0,Object(f["c"])(e,t).then((function(e){a.dataSource=e.data||[]})).finally((function(){a.loading=!1}))},close:function(){this.$emit("close"),this.visible=!1,this.modalStyle="",this.unitStatus=!1,this.manyUnitStatus=!0,this.unitChecked=!1,this.getAllTable().then((function(e){e[0].initialize(),e[1].initialize()}))},handleOk:function(){this.validateFields()},handleCancel:function(){this.close()},validateFields:function(){var e=this;this.getAllTable().then((function(t){return Object(u["e"])(e.form,t)})).then((function(t){var a=e.classifyIntoFormData(t);return a.sortList=[],void 0===a.unit&&(a.unit=""),void 0===a.unitId&&(a.unitId=""),e.unitChecked?a.unit="":a.unitId="",e.requestAddOrEdit(a)})).catch((function(t){t.error===u["b"]&&(e.activeKey=null==t.index?e.activeKey:(t.index+1).toString())}))},classifyIntoFormData:function(e){var t=Object.assign(this.model,e.formValue);return y(y({},t),{},{meList:e.tablesValue[0].values,stock:e.tablesValue[1].values})},requestAddOrEdit:function(e){var t=this;if(0!==e.meList.length)if("1"!==e.enableSerialNumber||"1"!==e.enableBatchNumber){var a={id:this.model.id?this.model.id:0,name:this.model.name,model:this.parseParam(this.model.model),color:this.parseParam(this.model.color),standard:this.parseParam(this.model.standard),mfrs:this.parseParam(this.model.mfrs),otherField1:this.parseParam(this.model.otherField1),otherField2:this.parseParam(this.model.otherField2),otherField3:this.parseParam(this.model.otherField3),unit:this.parseParam(this.model.unit),unitId:this.parseParam(this.model.unitId)};Object(m["t"])(a).then((function(a){if(a&&200===a.code){if(a.data.status)return void t.$message.warning("抱歉，该商品已存在！");var i="",r="",o="",n="";if(e.unitId)for(var l=t.unitList,s=0;s<l.length;s++)l[s].id==e.unitId&&(i=l[s].basicUnit,r=l[s].otherUnit,l[s].otherUnitTwo&&(o=l[s].otherUnitTwo),l[s].otherUnitThree&&(n=l[s].otherUnitThree));if(!e.unit){if(e.meList.length<2)return void t.$message.warning("多单位的商品条码行数至少要有两行，请再新增一行条码信息！");if(e.meList[0].commodityUnit!=i)return void t.$message.warning("条码之后的单位填写有误，单位【"+e.meList[0].commodityUnit+"】请修改为【"+i+"】！");if(e.meList[1].commodityUnit!=r)return void t.$message.warning("条码之后的单位填写有误，单位【"+e.meList[1].commodityUnit+"】请修改为【"+r+"】！")}for(var d=0,c=0;c<e.meList.length;c++){var u=e.meList[c].commodityUnit;if(e.unit){if(u!=e.unit)return void t.$message.warning("条码之后的单位填写有误，单位【"+u+"】请修改为【"+e.unit+"】！")}else if(e.unitId&&u!=i&&u!=r&&u!=o&&u!=n){var m="条码之后的单位填写有误，单位【"+u+"】请修改为【"+i+"】或【"+r+"】";return o&&(m+="或【"+o+"】"),n&&(m+="或【"+n+"】"),m+="！",void t.$message.warning(m)}e.sku&&d++}for(var h=0;h<e.stock.length;h++){var p=e.stock[h];if(d&&p.initStock&&p.initStock-0)return void t.$message.warning("抱歉，多属性商品不能录入期初库存，建议进行盘点录入！");if(p.lowSafeStock&&p.highSafeStock&&p.lowSafeStock-0>p.highSafeStock-0)return void t.$message.warning("抱歉，"+p.name+"的最低安全库存大于最高安全库存！")}if(t.fileList&&t.fileList.length>0){e.imgName=t.fileList;var b=t.fileList.split(",");if(b.length>4)return void t.$message.warning("抱歉，商品图片不能超过4张！")}else e.imgName="";e.meDeleteIdList=t.meDeleteIdList;var v=t.url.add,g="post";t.model.id&&(v=t.url.edit,g="put");var w=t;t.confirmLoading=!0,Object(f["e"])(v,e,g).then((function(e){200===e.code?(w.$emit("ok"),w.confirmLoading=!1,w.close()):(w.$message.warning(e.data.message),w.confirmLoading=!1)})).finally((function(){}))}}))}else this.$message.warning("抱歉，序列号和批号只能选择一项！");else this.$message.warning("抱歉，请输入条码信息！")},parseParam:function(e){return e||""},validateBarCode:function(e,t,a,i,r,o){var n={barCode:t,id:a.id.length>=20?0:a.id};Object(m["v"])(n).then((function(e){e&&200===e.code?e.data.status?r(!1,"该条码已经存在"):r(!0):r(!1,e.data)}))},loadTreeData:function(){var e=this,t={id:""};Object(m["sb"])(t).then((function(t){if(t){e.categoryTree=[];for(var a=0;a<t.length;a++){var i=t[a];e.categoryTree.push(i)}}}))},loadUnitListData:function(){var e=this,t={currentPage:1,pageSize:100};Object(f["c"])("/unit/getAllList",t).then((function(t){t&&(e.unitList=t.data)}))},onManySkuChange:function(e){var t=this;if(this.manySkuSelected=e.length,e.length<2?this.materialAttributeList.forEach((function(e,t,a){-1===a.indexOf(e.value)&&v["a"].set(a[t],"disabled",!1)})):this.materialAttributeList.forEach((function(t,a,i){-1===e.indexOf(t.value)&&v["a"].set(i[a],"disabled",!0)})),e.length<=2){var a=e[0],i=e[1];this.materialAttributeList.forEach((function(e){e.value===a&&(t.skuOneTitle=e.name),e.value===i&&(t.skuTwoTitle=e.name)})),Object(m["ib"])({id:a}).then((function(e){e&&(t.skuOneList=e)})),Object(m["ib"])({id:i}).then((function(e){e&&(t.skuTwoList=e)}))}e.length>0?this.meTable.columns[2].type=u["a"].input:this.meTable.columns[2].type=u["a"].hidden,this.barCodeSwitch=!1,this.meTable.dataSource=[]},onSkuChange:function(){var e=this.form.getFieldValue("skuOne"),t=this.form.getFieldValue("skuTwo");this.autoSkuList(e,t)},onSkuOneDeSelect:function(e){var t=this.form.getFieldValue("skuOne"),a=this.form.getFieldValue("skuTwo");Object(h["p"])(t,e),this.autoSkuList(t,a)},onSkuTwoDeSelect:function(e){var t=this.form.getFieldValue("skuOne"),a=this.form.getFieldValue("skuTwo");Object(h["p"])(a,e),this.autoSkuList(t,a)},autoSkuList:function(e,t){var a=this,i=this.form.getFieldValue("unit");if(i){var r=this.getNumByField("skuOne")+this.getNumByField("skuTwo"),o=[];if(1===r){var n=[];this.getNumByField("skuOne")?n=e:this.getNumByField("skuTwo")&&(n=t);for(var l=0;l<n.length;l++)o.push(n[l])}else if(2===r){var s=[];this.getNumByField("skuOne")&&s.push(e),this.getNumByField("skuTwo")&&s.push(t);for(var d=s[0],c=s[1],u=0;u<d.length;u++)for(var h=0;h<c.length;h++)o.push(d[u]+","+c[h])}var f=[];Object(m["mb"])({}).then((function(e){if(e&&200===e.code){for(var t=e.data.barCode-0,r=0;r<o.length;r++){var n=t+r+1;f.push({barCode:n,commodityUnit:i,sku:o[r]})}a.meTable.dataSource=f}}))}else this.$message.warning("请填写单位（注意不要勾选多单位）"),this.barCodeSwitch=!1},getNumByField:function(e){var t=0;return this.form.getFieldValue(e)&&this.form.getFieldValue(e).length>0&&(t=1),t},onAdded:function(e){var t=this,a=e.row,i=e.target,r="";0==this.unitStatus&&(r=this.form.getFieldValue("unit")),""===this.maxBarCodeInfo?Object(m["mb"])({}).then((function(e){e&&200===e.code&&(t.maxBarCodeInfo=e.data.barCode-0,t.maxBarCodeInfo=t.maxBarCodeInfo+1,i.setValues([{rowKey:a.id,values:{barCode:t.maxBarCodeInfo,commodityUnit:r||""}}]))})):(this.maxBarCodeInfo=this.maxBarCodeInfo+1,i.setValues([{rowKey:a.id,values:{barCode:this.maxBarCodeInfo,commodityUnit:r||""}}]))},onDeleted:function(e){this.meDeleteIdList=e},onValueChange:function(e){e.type;var t=e.row,a=e.column;e.value,e.target;switch(a.key){case"purchaseDecimal":case"commodityDecimal":case"wholesaleDecimal":case"lowDecimal":this.changeDecimalByValue(t);break}},changeDecimalByValue:function(e){for(var t=this,a=this.unitList,i="",r=1,o="",n=1,l="",s=1,d=0;d<a.length;d++)a[d].id===this.form.getFieldValue("unitId")&&(i=a[d].basicUnit,a[d].otherUnit,r=a[d].ratio,a[d].otherUnitTwo&&(o=a[d].otherUnitTwo,n=a[d].ratioTwo),a[d].otherUnitThree&&(l=a[d].otherUnitThree,s=a[d].ratioThree));e.commodityUnit===i&&this.$refs.editableMeTable.getValues((function(e,a){for(var i=a,d="",c="",u="",m="",h=0;h<i.length;h++){var f=i[h];0===h?(d=f.purchaseDecimal,c=f.commodityDecimal,u=f.wholesaleDecimal,m=f.lowDecimal):(d&&(f.purchaseDecimal=(d*r).toFixed(2)),c&&(f.commodityDecimal=(c*r).toFixed(2)),u&&(f.wholesaleDecimal=(u*r).toFixed(2)),m&&(f.lowDecimal=(m*r).toFixed(2)),o&&2===h&&(d&&(f.purchaseDecimal=(d*n).toFixed(2)),c&&(f.commodityDecimal=(c*n).toFixed(2)),u&&(f.wholesaleDecimal=(u*n).toFixed(2)),m&&(f.lowDecimal=(m*n).toFixed(2))),l&&3===h&&(d&&(f.purchaseDecimal=(d*s).toFixed(2)),c&&(f.commodityDecimal=(c*s).toFixed(2)),u&&(f.wholesaleDecimal=(u*s).toFixed(2)),m&&(f.lowDecimal=(m*s).toFixed(2))))}t.meTable.dataSource=i}))},batchSetPrice:function(e){this.manySkuSelected>0||this.model.id?(this.$refs.priceModalForm.add(e),this.$refs.priceModalForm.disableSubmit=!1):this.$message.warning("抱歉，只有开启多属性才能进行批量操作！")},batchSetStock:function(e){this.$refs.stockModalForm.add(e),this.$refs.stockModalForm.disableSubmit=!1},batchSetPriceModalFormOk:function(e,t){var a=this.meTable.dataSource;if(0===a.length)this.$message.warning("请先录入条码、单位等信息！");else{for(var i=[],r=0;r<a.length;r++){var o={barCode:a[r].barCode,commodityUnit:a[r].commodityUnit,sku:a[r].sku,purchaseDecimal:a[r].purchaseDecimal,commodityDecimal:a[r].commodityDecimal,wholesaleDecimal:a[r].wholesaleDecimal,lowDecimal:a[r].lowDecimal};"purchase"===t?o.purchaseDecimal=e-0:"commodity"===t?o.commodityDecimal=e-0:"wholesale"===t?o.wholesaleDecimal=e-0:"low"===t&&(o.lowDecimal=e-0),a[r].id&&(o.id=a[r].id),i.push(o)}this.meTable.dataSource=i}},batchSetStockModalFormOk:function(e,t){for(var a=this.depotTable.dataSource,i=[],r=0;r<a.length;r++){var o={name:a[r].name,initStock:a[r].initStock,lowSafeStock:a[r].lowSafeStock,highSafeStock:a[r].highSafeStock};"initStock"===t?o.initStock=e-0:"lowSafeStock"===t?o.lowSafeStock=e-0:"highSafeStock"===t&&(o.highSafeStock=e-0),a[r].id&&(o.id=a[r].id),i.push(o)}this.depotTable.dataSource=i},initMaterialAttribute:function(){var e=this;Object(m["hb"])().then((function(t){t&&(e.materialAttributeList=t)}))},loadParseMaterialProperty:function(){for(var e=v["a"].ls.get("materialPropertyList"),t=0;t<e.length;t++)"制造商"===e[t].nativeName&&(this.mpShort.mfrs.name=e[t].anotherName,this.mpShort.mfrs.enabled=e[t].enabled),"自定义1"===e[t].nativeName&&(this.mpShort.otherField1.name=e[t].anotherName,this.mpShort.otherField1.enabled=e[t].enabled),"自定义2"===e[t].nativeName&&(this.mpShort.otherField2.name=e[t].anotherName,this.mpShort.otherField2.enabled=e[t].enabled),"自定义3"===e[t].nativeName&&(this.mpShort.otherField3.name=e[t].anotherName,this.mpShort.otherField3.enabled=e[t].enabled)},onlyUnitOnChange:function(e){var t=this;e.target.value?this.manySkuStatus=!0:this.manySkuStatus=!1,this.$refs.editableMeTable.getValues((function(a,i){for(var r=i,o=0;o<r.length;o++){var n=r[o];n.commodityUnit=e.target.value}t.meTable.dataSource=r}))},manyUnitOnChange:function(e){for(var t=this,a=this.unitList,i="",r="",o=1,n="",l=1,s="",d=1,c=0;c<a.length;c++)a[c].id===e&&(i=a[c].basicUnit,r=a[c].otherUnit,o=a[c].ratio,a[c].otherUnitTwo&&(n=a[c].otherUnitTwo,l=a[c].ratioTwo),a[c].otherUnitThree&&(s=a[c].otherUnitThree,d=a[c].ratioThree));this.$refs.editableMeTable.getValues((function(e,a){for(var c=a,u="",m="",h="",f="",p=0;p<c.length;p++){var b=c[p];0===p?(b.commodityUnit=i,u=b.purchaseDecimal,m=b.commodityDecimal,h=b.wholesaleDecimal,f=b.lowDecimal):(b.commodityUnit=r,u&&(b.purchaseDecimal=(u*o).toFixed(2)),m&&(b.commodityDecimal=(m*o).toFixed(2)),h&&(b.wholesaleDecimal=(h*o).toFixed(2)),f&&(b.lowDecimal=(f*o).toFixed(2)),n&&2===p&&(b.commodityUnit=n,u&&(b.purchaseDecimal=(u*l).toFixed(2)),m&&(b.commodityDecimal=(m*l).toFixed(2)),h&&(b.wholesaleDecimal=(h*l).toFixed(2)),f&&(b.lowDecimal=(f*l).toFixed(2))),s&&3===p&&(b.commodityUnit=s,u&&(b.purchaseDecimal=(u*d).toFixed(2)),m&&(b.commodityDecimal=(m*d).toFixed(2)),h&&(b.wholesaleDecimal=(h*d).toFixed(2)),f&&(b.lowDecimal=(f*d).toFixed(2))))}t.meTable.dataSource=c}))},unitOnChange:function(e){var t=e.target.checked;t?(this.unitStatus=!0,this.manyUnitStatus=!1,this.unitChecked=!0):(this.unitStatus=!1,this.manyUnitStatus=!0,this.unitChecked=!1)},addUnit:function(){this.$refs.unitModalForm.add(),this.$refs.unitModalForm.title="新增计量单位",this.$refs.unitModalForm.disableSubmit=!1},unitModalFormOk:function(){this.loadUnitListData()}}},L=x,T=(a("718a"),a("e607")),O=Object(T["a"])(L,i,r,!1,null,"90f87c64",null);t["default"]=O.exports},"718a":function(e,t,a){"use strict";a("8057")},"790b":function(e,t,a){},8057:function(e,t,a){},"85ee":function(e,t,a){(function(t){var a=1/0,i=9007199254740991,r="[object Arguments]",o="[object Function]",n="[object GeneratorFunction]",l="[object Symbol]",s="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,c=s||d||Function("return this")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function m(e,t){var a=-1,i=e?e.length:0,r=Array(i);while(++a<i)r[a]=t(e[a],a,e);return r}function h(e,t){var a=-1,i=t.length,r=e.length;while(++a<i)e[r+a]=t[a];return e}var f=Object.prototype,p=f.hasOwnProperty,b=f.toString,v=c.Symbol,g=f.propertyIsEnumerable,w=v?v.isConcatSpreadable:void 0,y=Math.max;function S(e,t,a,i,r){var o=-1,n=e.length;a||(a=L),r||(r=[]);while(++o<n){var l=e[o];t>0&&a(l)?t>1?S(l,t-1,a,i,r):h(r,l):i||(r[r.length]=l)}return r}function k(e,t){return e=Object(e),C(e,t,(function(t,a){return a in e}))}function C(e,t,a){var i=-1,r=t.length,o={};while(++i<r){var n=t[i],l=e[n];a(l,n)&&(o[n]=l)}return o}function x(e,t){return t=y(void 0===t?e.length-1:t,0),function(){var a=arguments,i=-1,r=y(a.length-t,0),o=Array(r);while(++i<r)o[i]=a[t+i];i=-1;var n=Array(t+1);while(++i<t)n[i]=a[i];return n[t]=o,u(e,this,n)}}function L(e){return F(e)||O(e)||!!(w&&e&&e[w])}function T(e){if("string"==typeof e||_(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function O(e){return U(e)&&p.call(e,"callee")&&(!g.call(e,"callee")||b.call(e)==r)}var F=Array.isArray;function D(e){return null!=e&&j(e.length)&&!N(e)}function U(e){return $(e)&&D(e)}function N(e){var t=I(e)?b.call(e):"";return t==o||t==n}function j(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function I(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function $(e){return!!e&&"object"==typeof e}function _(e){return"symbol"==typeof e||$(e)&&b.call(e)==l}var M=x((function(e,t){return null==e?{}:k(e,m(S(t,1),T))}));e.exports=M}).call(this,a("2409"))},"93af":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{ref:"container"},[t("a-modal",{staticStyle:{top:"30%",height:"30%"},attrs:{title:e.title,width:500,visible:e.visible,"confirm-loading":e.confirmLoading,getContainer:function(){return e.$refs.container},maskStyle:{top:"93px",left:"154px"},wrapClassName:e.wrapClassNameInfo(),mask:e.isDesktop(),maskClosable:!1,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("template",{slot:"footer"},[e.isReadOnly?t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n        关闭\n      ")]):e._e()],1),t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"请输入价格"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["price",e.validatorRules.price],expression:"[ 'price', validatorRules.price]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入价格"}})],1)],1)],1)],2)],1)},r=[],o=a("ac0d"),n={name:"BatchSetPriceModal",mixins:[o["b"]],data:function(){return{title:"批量设置",visible:!1,isReadOnly:!1,batchType:"",model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{price:{rules:[{required:!0,message:"请输入价格!"}]}}}},created:function(){},methods:{add:function(e){this.batchType=e,"purchase"===e?this.title="采购价-批量设置":"commodity"===e?this.title="零售价-批量设置":"wholesale"===e?this.title="销售价-批量设置":"low"===e&&(this.title="最低售价-批量设置"),this.edit({})},edit:function(e){this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this.form.getFieldValue("price");this.$emit("ok",e,this.batchType),this.visible=!1},handleCancel:function(){this.close()}}},l=n,s=a("e607"),d=Object(s["a"])(l,i,r,!1,null,"6c007fde",null);t["default"]=d.exports},"9ff8":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{ref:"container"},[t("a-modal",{staticStyle:{top:"30%",height:"30%"},attrs:{title:e.title,width:500,visible:e.visible,"confirm-loading":e.confirmLoading,getContainer:function(){return e.$refs.container},maskStyle:{top:"93px",left:"154px"},wrapClassName:e.wrapClassNameInfo(),mask:e.isDesktop(),maskClosable:!1,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("template",{slot:"footer"},[e.isReadOnly?t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n        关闭\n      ")]):e._e()],1),t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"请输入数量"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["number",e.validatorRules.number],expression:"[ 'number', validatorRules.number]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入数量"}})],1)],1)],1)],2)],1)},r=[],o=a("ac0d"),n={name:"BatchSetStockModal",mixins:[o["b"]],data:function(){return{title:"批量设置",visible:!1,isReadOnly:!1,batchType:"",model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{number:{rules:[{required:!0,message:"请输入数量!"}]}}}},created:function(){},methods:{add:function(e){this.batchType=e,"initStock"===e?this.title="期初库存-批量设置":"lowSafeStock"===e?this.title="最低安全库存-批量设置":"highSafeStock"===e&&(this.title="最高安全库存-批量设置"),this.edit({})},edit:function(e){this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this.form.getFieldValue("number");this.$emit("ok",e,this.batchType),this.visible=!1},handleCancel:function(){this.close()}}},l=n,s=a("e607"),d=Object(s["a"])(l,i,r,!1,null,"19c2132d",null);t["default"]=d.exports},cf74:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{position:"relative"},attrs:{id:e.containerId}},[t("div",{staticClass:"movety-container",staticStyle:{padding:"0 8px",position:"absolute","z-index":"91",height:"32px",width:"104px","text-align":"center"},style:{top:e.top+"px",left:e.left+"px",display:e.moveDisplay}},[t("div",{class:e.showMoverTask?"uploadty-mover-mask":"movety-opt",staticStyle:{"margin-top":"12px"},attrs:{id:e.containerId+"-mover"}},[t("a",{staticStyle:{margin:"0 5px"},on:{click:e.moveLast}},[t("a-icon",{staticStyle:{color:"#fff","font-size":"16px"},attrs:{type:"arrow-left"}})],1),t("a",{staticStyle:{margin:"0 5px"},on:{click:e.moveNext}},[t("a-icon",{staticStyle:{color:"#fff","font-size":"16px"},attrs:{type:"arrow-right"}})],1)])]),t("a-upload",{class:{"uploadty-disabled":e.disabled},attrs:{name:"file",multiple:!0,action:e.uploadAction,headers:e.headers,data:{biz:e.bizPath},fileList:e.fileList,beforeUpload:e.beforeUpload,disabled:e.disabled,returnUrl:e.returnUrl,listType:e.complistType},on:{change:e.handleChange,preview:e.handlePreview}},[[e.isImageComp?t("div",[t("a-icon",{attrs:{type:"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v(e._s(e.text))])],1):e.buttonVisible?t("a-button",[t("a-icon",{attrs:{type:"upload"}}),e._v(e._s(e.text)+"\n      ")],1):e._e()]],2),t("a-modal",{attrs:{visible:e.previewVisible,width:1e3,footer:null},on:{cancel:e.handleCancel}},[t("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)},r=[],o=a("1f37"),n=a("9fb0"),l=a("0fea"),s=a("4ec3"),d="all",c="image",u=function(){return"-"+parseInt(1e4*Math.random()+1,10)},m=function(e){if(e.lastIndexOf("\\")>=0){var t=new RegExp("\\\\","g");e=e.replace(t,"/")}return e.substring(e.lastIndexOf("/")+1)},h={name:"JUpload",data:function(){return{uploadAction:window._CONFIG["domianURL"]+"/systemConfig/upload",headers:{},fileList:[],newFileList:[],uploadGoOn:!0,previewVisible:!1,previewImage:"",containerId:"",top:"",left:"",moveDisplay:"none",showMoverTask:!1,moverHold:!1,currentImg:"",sizeLimit:0}},props:{text:{type:String,required:!1,default:"点击上传"},fileType:{type:String,required:!1,default:d},bizPath:{type:String,required:!1,default:"temp"},value:{type:[String,Array],required:!1},disabled:{type:Boolean,required:!1,default:!1},triggerChange:{type:Boolean,required:!1,default:!1},returnUrl:{type:Boolean,required:!1,default:!0},number:{type:Number,required:!1,default:0},buttonVisible:{type:Boolean,required:!1,default:!0}},watch:{value:{immediate:!0,handler:function(){var e=this.value;e instanceof Array?this.returnUrl?this.initFileList(e.join(",")):this.initFileListArr(e):this.initFileList(e)}}},computed:{isImageComp:function(){return this.fileType===c},complistType:function(){return this.fileType===c?"picture-card":"text"}},created:function(){this.initFileSizeLimit();var e=o["a"].ls.get(n["a"]);this.headers={"X-Access-Token":e},this.containerId="container-ty-"+(new Date).getTime()},methods:{initFileSizeLimit:function(){var e=this;Object(s["T"])().then((function(t){200===t.code&&(e.sizeLimit=t.data)}))},initFileListArr:function(e){if(e&&0!=e.length){for(var t=[],a=0;a<e.length;a++){var i=Object(l["d"])(e[a].filePath);t.push({uid:u(),name:e[a].fileName,status:"done",url:i,response:{code:"history",data:e[a].filePath}})}this.fileList=t}else this.fileList=[]},initFileList:function(e){if(e&&0!=e.length){for(var t=[],a=e.split(","),i=0;i<a.length;i++){var r=Object(l["d"])("systemConfig/static/"+a[i]);t.push({uid:u(),name:m(a[i]),status:"done",url:r,response:{code:"history",data:a[i]}})}this.fileList=t}else this.fileList=[]},handlePathChange:function(){var e=this.fileList,t="";e&&0!=e.length||(t="");for(var a=[],i=0;i<e.length;i++)a.push(e[i].response.data);a.length>0&&(t=a.join(",")),this.$emit("change",t)},beforeUpload:function(e){this.uploadGoOn=!0;var t=e.type,a=e.size;if(this.fileType===c&&t.indexOf("image")<0)return this.$message.warning("请上传图片"),this.uploadGoOn=!1,!1;if(a>this.sizeLimit){var i=(this.sizeLimit/1024/1024).toFixed(2);return this.$message.warning("抱歉，文件大小不能超过"+i+"M"),this.uploadGoOn=!1,!1}return!0},handleChange:function(e){e.file.status||!1!==this.uploadGoOn||e.fileList.pop();var t=e.fileList;if("done"===e.file.status?(this.number>0&&(t=t.slice(-this.number)),200===e.file.response.code&&(t=t.map((function(e){if(e.response){var t=e.response.data;e.url=Object(l["d"])(t)}return e})))):"error"===e.file.status?this.$message.error("".concat(e.file.name," 上传失败.")):"removed"===e.file.status&&this.handleDelete(e.file),this.fileList=t,"done"===e.file.status||"removed"===e.file.status)if(this.returnUrl)this.handlePathChange();else{this.newFileList=[];for(var a=0;a<t.length;a++){var i={fileName:t[a].name,filePath:t[a].response.data,fileSize:t[a].size};this.newFileList.push(i)}this.$emit("change",this.newFileList)}},handleDelete:function(e){},handlePreview:function(e){var t=e.name.substring(e.name.indexOf("."));".gif"===t||".jpg"===t||".jpeg"===t||".png"===t||".GIF"===t||".JPG"===t||".JPEG"===t||".PNG"===t?(this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0):location.href=e.url},handleCancel:function(){this.previewVisible=!1},moveLast:function(){var e=this.getIndexByUrl();if(0==e)this.$message.warn("未知的操作");else{for(var t=this.fileList[e].url,a=this.fileList[e-1].url,i=[],r=0;r<this.fileList.length;r++)r==e-1?i.push(t):r==e?i.push(a):i.push(this.fileList[r].url);this.currentImg=a,this.$emit("change",i.join(","))}},moveNext:function(){var e=this.getIndexByUrl();if(e==this.fileList.length-1)this.$message.warn("已到最后~");else{for(var t=this.fileList[e].url,a=this.fileList[e+1].url,i=[],r=0;r<this.fileList.length;r++)r==e+1?i.push(t):r==e?i.push(a):i.push(this.fileList[r].url);this.currentImg=a,this.$emit("change",i.join(","))}},getIndexByUrl:function(){for(var e=0;e<this.fileList.length;e++)if(this.fileList[e].url===this.currentImg||encodeURI(this.fileList[e].url)===this.currentImg)return e;return-1}},mounted:function(){var e=this,t=document.getElementById(this.containerId+"-mover");t.addEventListener("mouseover",(function(){e.moverHold=!0,e.moveDisplay="block"})),t.addEventListener("mouseout",(function(){e.moverHold=!1,e.moveDisplay="none"}));var a=document.getElementById(this.containerId)?document.getElementById(this.containerId).getElementsByClassName("ant-upload-list-picture-card"):[];a&&a.length>0&&(a[0].addEventListener("mouseover",(function(t){t=t||window.event;var a=t.target||t.srcElement;if("ant-upload-list-item-info"==a.className){e.showMoverTask=!1;var i=a.parentElement;e.left=i.offsetLeft,e.top=i.offsetTop+i.offsetHeight-50,e.moveDisplay="block",e.currentImg=a.getElementsByTagName("img")[0].src}})),a[0].addEventListener("mouseout",(function(t){t=t||window.event;var a=t.target||t.srcElement;"ant-upload-list-item-info"==a.className&&(e.showMoverTask=!0,setTimeout((function(){!1===e.moverHold&&(e.moveDisplay="none")}),100)),"ant-upload-list-item ant-upload-list-item-done"!=a.className&&"ant-upload-list ant-upload-list-picture-card"!=a.className||(e.moveDisplay="none")})))},model:{prop:"value",event:"change"}},f=h,p=(a("3d9e"),a("e607")),b=Object(p["a"])(f,i,r,!1,null,null,null);t["default"]=b.exports},e610:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-upload",{attrs:{name:"file",listType:"picture-card",multiple:e.isMultiple,action:e.uploadAction,headers:e.headers,data:{biz:e.bizPath},fileList:e.fileList,beforeUpload:e.beforeUpload,disabled:e.disabled,isMultiple:e.isMultiple,showUploadList:e.isMultiple},on:{change:e.handleChange,preview:e.handlePreview}},[!e.isMultiple&&e.picUrl?t("img",{staticStyle:{height:"104px","max-width":"300px"},attrs:{src:e.getAvatarView()}}):t("div",[t("a-icon",{attrs:{type:e.uploadLoading?"loading":"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v(e._s(e.text))])],1),t("a-modal",{attrs:{visible:e.previewVisible,width:1e3,footer:null},on:{cancel:function(t){return e.handleCancel()}}},[t("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)},r=[],o=a("1f37"),n=a("9fb0"),l=a("0fea"),s=a("4ec3"),d=function(){return"-"+parseInt(1e4*Math.random()+1,10)},c=function(e){if(e.lastIndexOf("\\")>=0){var t=new RegExp("\\\\","g");e=e.replace(t,"/")}return e.substring(e.lastIndexOf("/")+1)},u={name:"JImageUpload",data:function(){return{uploadAction:window._CONFIG["domianURL"]+"/systemConfig/upload",uploadLoading:!1,picUrl:!1,headers:{},fileList:[],previewImage:"",previewVisible:!1,sizeLimit:0,uploadGoOn:!0}},props:{text:{type:String,required:!1,default:"上传"},bizPath:{type:String,required:!1,default:"temp"},value:{type:[String,Array],required:!1},disabled:{type:Boolean,required:!1,default:!1},isMultiple:{type:Boolean,required:!1,default:!1}},watch:{value:function(e){e instanceof Array?this.initFileList(e.join(",")):this.initFileList(e)}},created:function(){this.initFileSizeLimit();var e=o["a"].ls.get(n["a"]);this.headers={"X-Access-Token":e}},methods:{initFileSizeLimit:function(){var e=this;Object(s["T"])().then((function(t){200===t.code&&(e.sizeLimit=t.data)}))},initFileList:function(e){if(!e||0==e.length)return this.fileList=[],void(this.picUrl=!1);this.picUrl=!0;for(var t=[],a=e.split(","),i=0;i<a.length;i++){var r=Object(l["d"])("systemConfig/static/"+a[i]);t.push({uid:d(),name:c(a[i]),status:"done",url:r,response:{code:"history",data:a[i]}})}this.fileList=t},beforeUpload:function(e){this.uploadGoOn=!0;var t=e.type,a=e.size;if(t.indexOf("image")<0)return this.$message.warning("请上传图片"),this.uploadGoOn=!1,!1;if(a>this.sizeLimit/10){var i=(this.sizeLimit/1024/1024/10).toFixed(2);return this.$message.warning("抱歉，图片大小不能超过"+i+"M"),this.uploadGoOn=!1,!1}return!0},handleChange:function(e){e.file.status||!1!==this.uploadGoOn||e.fileList.pop(),this.picUrl=!1;var t=e.fileList;"done"===e.file.status?200===e.file.response.code&&(this.picUrl=!0,t=t.map((function(e){return e.response&&(e.url=e.response.data),e}))):"error"===e.file.status?this.$message.error("".concat(e.file.name," 上传失败.")):"removed"===e.file.status&&this.handleDelete(e.file),this.fileList=t,"done"!==e.file.status&&"removed"!==e.file.status||this.handlePathChange()},handlePreview:function(e){this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0},getAvatarView:function(){if(this.fileList.length>0){var e=this.fileList[0].url;return e}},handlePathChange:function(){var e=this.fileList,t="";e&&0!=e.length||(t="");var a=[];if(this.isMultiple)for(var i=0;i<e.length;i++)a.push(e[i].response.data);else a.push(e[e.length-1].response.data);a.length>0&&(t=a.join(",")),this.$emit("change",t)},handleDelete:function(e){},handleCancel:function(){this.close(),this.previewVisible=!1},close:function(){}},model:{prop:"value",event:"change"}},m=u,h=a("e607"),f=Object(h["a"])(m,i,r,!1,null,"15e51f3a",null);t["default"]=f.exports}}]);