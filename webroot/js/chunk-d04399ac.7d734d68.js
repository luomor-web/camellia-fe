(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d04399ac","chunk-69230cad","chunk-2d21e3e9"],{"278e":function(t,e,a){},8310:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24}},[e("a-card",{style:t.cardStyle,attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"仓库",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple",maxTagCount:1,optionFilterProp:"children",showSearch:"",placeholder:"请选择仓库"},model:{value:t.depotSelected,callback:function(e){t.depotSelected=e},expression:"depotSelected"}},t._l(t.depotList,(function(a,r){return e("a-select-option",{attrs:{value:a.id}},[t._v("\n                    "+t._s(a.depotName)+"\n                  ")])})),1)],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"商品信息",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-input",{attrs:{placeholder:"条码/名称/规格/型号/颜色"},model:{value:t.queryParam.materialParam,callback:function(e){t.$set(t.queryParam,"materialParam",e)},expression:"queryParam.materialParam"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-button",{attrs:{type:"primary"},on:{click:t.searchQuery}},[t._v("查询")]),e("a-button",{directives:[{name:"print",rawName:"v-print",value:"#reportPrint",expression:"'#reportPrint'"}],staticStyle:{"margin-left":"8px"},attrs:{icon:"printer"}},[t._v("打印")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"download"},on:{click:t.exportExcel}},[t._v("导出")]),e("a",{staticStyle:{"margin-left":"8px"},on:{click:t.handleToggleSearch}},[t._v("\n                  "+t._s(t.toggleSearchStatus?"收起":"展开")+"\n                  "),e("a-icon",{attrs:{type:t.toggleSearchStatus?"up":"down"}})],1)],1)]),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",[e("span",[t._v("总库存："+t._s(t.currentStock)+"，总库存金额："+t._s(t.currentStockPrice)+"，总重量："+t._s(t.currentWeight))])])],1),t.toggleSearchStatus?[e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"类别",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-tree-select",{staticStyle:{width:"100%"},attrs:{dropdownStyle:{maxHeight:"200px",overflow:"auto"},"allow-clear":"",treeData:t.categoryTree,placeholder:"请选择类别"},model:{value:t.queryParam.categoryId,callback:function(e){t.$set(t.queryParam,"categoryId",e)},expression:"queryParam.categoryId"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"仓位货架",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入仓位货架查询"},model:{value:t.queryParam.position,callback:function(e){t.$set(t.queryParam,"position",e)},expression:"queryParam.position"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"零库存",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-select",{model:{value:t.queryParam.zeroStock,callback:function(e){t.$set(t.queryParam,"zeroStock",e)},expression:"queryParam.zeroStock"}},[e("a-select-option",{attrs:{value:"0"}},[t._v("隐藏")]),e("a-select-option",{attrs:{value:"1"}},[t._v("显示")])],1)],1)],1)]:t._e()],2)],1)],1),e("section",{ref:"print",attrs:{id:"reportPrint"}},[e("a-table",{ref:"table",attrs:{bordered:"",size:"middle",rowKey:"id",columns:t.columns,dataSource:t.dataSource,components:t.handleDrag(t.columns),pagination:!1,scroll:t.scroll,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"action",fn:function(a,r){return e("span",{},[e("a",{on:{click:function(e){return t.showMaterialInOutList(r)}}},[t._v(t._s(r.id?"流水":""))])])}},{key:"customRenderStock",fn:function(a,r){return[e("a-tooltip",{attrs:{title:r.bigUnitStock}},[t._v("\n                "+t._s(a)+"\n              ")])]}}])}),e("a-row",{staticStyle:{"margin-top":"8px","text-align":"right"},attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-pagination",{attrs:{size:"small","show-size-changer":"",showQuickJumper:!0,current:t.ipagination.current,"page-size":t.ipagination.pageSize,"page-size-options":t.ipagination.pageSizeOptions,total:t.ipagination.total,"show-total":function(e,a){return"共 ".concat(e-Math.ceil(e/t.ipagination.pageSize)," 条")}},on:{change:t.paginationChange,showSizeChange:t.paginationShowSizeChange},scopedSlots:t._u([{key:"buildOptionText",fn:function(a){return[e("span",[t._v(t._s(a.value-1)+"条/页")])]}}])})],1)],1)],1),e("material-in-out-list",{ref:"materialInOutList",on:{ok:t.modalFormOk}})],1)],1)],1)},i=[],n=a("93d9"),o=a("b65a"),l=a("0fea"),s=a("4ec3"),c=a("ca00"),d=a("d579"),u=a("2f42"),p=a.n(u),m=a("1f37"),h={name:"MaterialStock",mixins:[o["a"]],components:{MaterialInOutList:n["default"],JEllipsis:d["default"]},data:function(){return{labelCol:{span:5},wrapperCol:{span:18,offset:1},queryParam:{categoryId:"",materialParam:"",position:"",zeroStock:"0",mpList:Object(c["g"])(m["a"].ls.get("materialPropertyList"))},ipagination:{pageSize:11,pageSizeOptions:["11","21","31","101","201","301","1001","2001","3001"]},depotSelected:[],depotList:[],categoryTree:[],currentStock:"",currentStockPrice:"",columns:[{title:"#",dataIndex:"rowIndex",width:40,align:"center",customRender:function(t,e,a){return"合计"!==t?parseInt(a)+1:t}},{title:"库存流水",dataIndex:"action",align:"center",width:60,scopedSlots:{customRender:"action"}},{title:"条码",dataIndex:"mBarCode",width:80},{title:"名称",dataIndex:"name",width:140,ellipsis:!0},{title:"规格",dataIndex:"standard",width:100,ellipsis:!0},{title:"型号",dataIndex:"model",width:100,ellipsis:!0},{title:"颜色",dataIndex:"color",width:60,ellipsis:!0},{title:"类别",dataIndex:"categoryName",width:60,ellipsis:!0},{title:"仓位货架",dataIndex:"position",width:60,ellipsis:!0},{title:"单位",dataIndex:"unitName",width:60,ellipsis:!0},{title:"单价",dataIndex:"purchaseDecimal",sorter:function(t,e){return t.purchaseDecimal-e.purchaseDecimal},width:60},{title:"初始库存",dataIndex:"initialStock",sorter:function(t,e){return t.initialStock-e.initialStock},width:60},{title:"库存",dataIndex:"currentStock",sorter:function(t,e){return t.currentStock-e.currentStock},width:60,scopedSlots:{customRender:"customRenderStock"}},{title:"库存金额",dataIndex:"currentStockPrice",sorter:function(t,e){return t.currentStockPrice-e.currentStockPrice},width:80},{title:"重量",dataIndex:"currentWeight",sorter:function(t,e){return t.currentWeight-e.currentWeight},width:60}],url:{list:"/material/getListWithStock"}}},created:function(){this.getDepotData(),this.loadTreeData()},mounted:function(){this.scroll.x=1620},methods:{moment:p.a,getQueryParams:function(){var t=Object.assign({},this.queryParam,this.isorter);return this.depotSelected&&this.depotSelected.length>0&&(t.depotIds=this.depotSelected.join()),t.field=this.getQueryField(),t.currentPage=this.ipagination.current,t.pageSize=this.ipagination.pageSize-1,t},getDepotData:function(){var t=this;Object(l["c"])("/depot/findDepotByCurrentUser").then((function(e){200===e.code?t.depotList=e.data:t.$message.info(e.data)}))},loadTreeData:function(){var t=this,e={id:""};Object(s["sb"])(e).then((function(e){if(e){t.categoryTree=[];for(var a=0;a<e.length;a++){var r=e[a];t.categoryTree.push(r)}}}))},searchQuery:function(){this.loadData(1)},loadData:function(t){var e=this;1===t&&(this.ipagination.current=1);var a=this.getQueryParams();this.loading=!0,Object(l["c"])(this.url.list,a).then((function(t){200===t.code&&(e.dataSource=t.data.rows,e.ipagination.total=t.data.total,e.tableAddTotalRow(e.columns,e.dataSource),e.currentStock=t.data.currentStock.toFixed(2),e.currentStockPrice=t.data.currentStockPrice.toFixed(2),e.currentWeight=t.data.currentWeight.toFixed(2)),510===t.code&&e.$message.warning(t.data),e.loading=!1}))},showMaterialInOutList:function(t){var e="";this.depotSelected&&this.depotSelected.length>0&&(e=this.depotSelected.join()),this.$refs.materialInOutList.show(t,e),this.$refs.materialInOutList.title="查看商品库存流水",this.$refs.materialInOutList.disableSubmit=!1},exportExcel:function(){for(var t=[["条码","名称","规格","型号","颜色","类别","单位","单价","初始库存","库存","库存金额","重量"]],e=0;e<this.dataSource.length;e++){var a=this.dataSource[e],r=[a.mBarCode,a.name,a.standard,a.model,a.color,a.categoryName,a.unitName,a.purchaseDecimal,a.initialStock,a.currentStock,a.currentStockPrice,a.currentWeight];t.push(r)}Object(c["l"])(Object(c["q"])(t),"商品库存")}}},f=h,g=(a("d2a6"),a("e607")),b=Object(g["a"])(f,r,i,!1,null,"aa750722",null);e["default"]=b.exports},"93d9":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{ref:"container"},[e("a-modal",{staticStyle:{top:"20px",height:"95%"},attrs:{title:t.title,width:1200,visible:t.visible,getContainer:function(){return t.$refs.container},maskStyle:{top:"93px",left:"154px"},wrapClassName:t.wrapClassNameInfo(),mask:t.isDesktop(),maskClosable:!1,cancelText:"关闭"},on:{cancel:t.handleCancel}},[e("template",{slot:"footer"},[e("a-button",{key:"back",on:{click:t.handleCancel}},[t._v("取消")])],1),e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"单据编号",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-input",{attrs:{placeholder:"请输入单据编号"},model:{value:t.queryParam.number,callback:function(e){t.$set(t.queryParam,"number",e)},expression:"queryParam.number"}})],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"单据日期",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-range-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",placeholder:["开始时间","结束时间"]},on:{change:t.onDateChange,ok:t.onDateOk},model:{value:t.queryParam.createTimeRange,callback:function(e){t.$set(t.queryParam,"createTimeRange",e)},expression:"queryParam.createTimeRange"}})],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-button",{attrs:{type:"primary"},on:{click:t.searchQuery}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.searchReset}},[t._v("重置")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"download"},on:{click:t.exportExcel}},[t._v("导出")])],1)],1)],1)],1),e("a-table",{ref:"table",attrs:{bordered:"",size:"middle",rowKey:"id",columns:t.columns,dataSource:t.dataSource,pagination:t.ipagination,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"numberCustomRender",fn:function(a,r){return e("span",{},[e("a",{on:{click:function(e){return t.myHandleDetail(r)}}},[t._v(t._s(r.number))])])}}])}),e("bill-detail",{ref:"billDetail"})],2)],1)},i=[],n=a("9be9"),o=a("b65a"),l=a("d579"),s=a("4ec3"),c=a("ca00"),d=a("ac0d"),u={name:"MaterialInOutList",mixins:[o["a"],d["b"]],components:{BillDetail:n["default"],JEllipsis:l["default"]},data:function(){return{title:"操作",visible:!1,disableMixinCreated:!1,toFromType:"",currentMaterialId:"",queryParam:{depotIds:"",materialId:"",number:"",beginTime:"",endTime:""},ipagination:{pageSizeOptions:["10","20","30","100","200"]},tabKey:"1",columns:[{title:"#",dataIndex:"",key:"rowIndex",width:40,align:"center",customRender:function(t,e,a){return parseInt(a)+1}},{title:"单据编号",dataIndex:"number",width:100,scopedSlots:{customRender:"numberCustomRender"}},{title:"类型",dataIndex:"type",width:100},{title:"条码",dataIndex:"barCode",width:100},{title:"名称",dataIndex:"materialName",width:200},{title:"仓库名称",dataIndex:"depotName",width:80},{title:"数量",dataIndex:"basicNumber",width:70},{title:"日期",dataIndex:"operTime",width:110}],labelCol:{xs:{span:1},sm:{span:2}},wrapperCol:{xs:{span:10},sm:{span:16}},url:{list:"/depotItem/findDetailByDepotIdsAndMaterialId"}}},created:function(){},methods:{getQueryParams:function(){var t=Object.assign({},this.queryParam,this.isorter);return t.field=this.getQueryField(),t.materialId=this.currentMaterialId,t.currentPage=this.ipagination.current,t.pageSize=this.ipagination.pageSize,t},show:function(t,e){this.model=Object.assign({},t),this.currentMaterialId=t.id,this.visible=!0,this.queryParam.depotIds=e,this.queryParam.materialId=t.id,this.loadData(1)},close:function(){this.$emit("close"),this.visible=!1},handleCancel:function(){this.close()},onDateChange:function(t,e){this.queryParam.beginTime=e[0],this.queryParam.endTime=e[1]},onDateOk:function(t){},myHandleDetail:function(t){var e=this,a=this;this.toFromType=t.fromType,Object(s["U"])({number:t.number}).then((function(r){r&&200===r.code&&(e.$refs.billDetail.isCanBackCheck=!1,a.$refs.billDetail.show(r.data,t.type),a.$refs.billDetail.title="详情")}))},exportExcel:function(){for(var t=[["单据编号","类型","条码","名称","仓库名称","数量","日期"]],e=0;e<this.dataSource.length;e++){var a=this.dataSource[e],r=[a.number,a.type,a.barCode,a.materialName,a.depotName,a.basicNumber,a.operTime];t.push(r)}Object(c["l"])(Object(c["q"])(t),"商品库存流水")}}},p=u,m=(a("e28e"),a("e607")),h=Object(m["a"])(p,r,i,!1,null,"88d8ee5c",null);e["default"]=h.exports},cf4c:function(t,e,a){},d2a6:function(t,e,a){"use strict";a("cf4c")},d579:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-tooltip",{attrs:{placement:"topLeft"}},[e("template",{slot:"title"},[e("span",[t._v(t._s(t.value))])]),t._v("\n  "+t._s(t._f("ellipsis")(t.value,t.length))+"\n")],2)},i=[],n={name:"JEllipsis",props:{value:{type:String,required:!1},length:{type:Number,required:!1,default:25}}},o=n,l=a("e607"),s=Object(l["a"])(o,r,i,!1,null,"4de15389",null);e["default"]=s.exports},e28e:function(t,e,a){"use strict";a("278e")}}]);